
# ------------------------------------------------------------------------------
# ------------------------------------------------------------------------------
# --------------------- Word Form Data Extraction Debug ------------------------
# ------------------------------------------------------------------------------
# ------------------------------------------------------------------------------

# This script exports an xml version of the input docx file for debugging.

# Developed by Brian Sullivan || bcsullivan@guidehouse.com

# ------------------------------------------------------------------------------
# ------------------------------------------------------------------------------
# ------------------------------------------------------------------------------
# ------------------------------------------------------------------------------
# ------------------------------------------------------------------------------

# ------------------------------------------------------------------------------
# ------------------------- Set-up / Package Imports ---------------------------
# ------------------------------------------------------------------------------


# Standard Library Imports
import sys

# Local Imports
from src.functions.data_extraction import print_xml


# ------------------------------------------------------------------------------
# -------------------------- Function Definition -------------------------------
# ------------------------------------------------------------------------------


def main():
    # Check if a file path was entered
    if len(sys.argv) > 1:
        file_path = sys.argv[1]
        default = ''
    else:
        # else it defaults to the location of the template file
        file_path = r'.\src\input\apgCoverSheet_v1.0_template_WORKING.docx'
        default = 'Default '
    
    # Write the output to output.xml
    print_xml(file_path)
    
    # Print success message
    print(f'{default}.xml file generated in src/output')
    print("--- Usage: python debug.py [path] to output an xml file. ---")
    
    return


# ------------------------------------------------------------------------------
# ----------------------------- Function Call ----------------------------------
# ------------------------------------------------------------------------------

# Run the main function
if __name__ == '__main__':
    main()


# ------------------------------------------------------------------------------
# ------------------------------------------------------------------------------
# ----------------------------- End Script -------------------------------------
# ------------------------------------------------------------------------------
# ------------------------------------------------------------------------------
